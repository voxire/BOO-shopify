{% assign sid = section.id | replace: '_', '' | downcase %}

{%- liquid
  assign section_padding_top = section.settings.section_padding_top | default: 0
  assign section_padding_bottom = section.settings.section_padding_bottom | default: 0
  assign section_padding_left = section.settings.section_padding_left | default: 0
  assign section_padding_right = section.settings.section_padding_right | default: 0
  assign section_margin_top = section.settings.section_margin_top | default: 0
  assign section_margin_bottom = section.settings.section_margin_bottom | default: 0
  assign heading_padding_top = section.settings.heading_padding_top | default: 0
  assign heading_padding_bottom = section.settings.heading_padding_bottom | default: 0
  assign heading_padding_left = section.settings.heading_padding_left | default: 20
  assign heading_padding_right = section.settings.heading_padding_right | default: 20
  assign age_filter_margin_top = section.settings.age_filter_margin_top | default: 16
  assign age_filter_margin_bottom = section.settings.age_filter_margin_bottom | default: 0
  assign mobile_carousel_padding_top = section.settings.mobile_carousel_padding_top | default: 20
  assign mobile_carousel_padding_bottom = section.settings.mobile_carousel_padding_bottom | default: 40
  assign mobile_carousel_padding_left = section.settings.mobile_carousel_padding_left | default: 0
  assign mobile_carousel_padding_right = section.settings.mobile_carousel_padding_right | default: 0
  assign grid_wrap_padding_top = section.settings.grid_wrap_padding_top | default: 0
  assign grid_wrap_padding_bottom = section.settings.grid_wrap_padding_bottom | default: 0
  assign grid_wrap_padding_left = section.settings.grid_wrap_padding_left | default: 40
  assign grid_wrap_padding_right = section.settings.grid_wrap_padding_right | default: 40
-%}

{% style %}
/* ===== ANIMATED GAMING STYLE ===== */
.scg-heading-wrapper {
  text-align: center;
  padding: {{ heading_padding_top }}px {{ heading_padding_right }}px {{ heading_padding_bottom }}px {{ heading_padding_left }}px;
  position: relative;
  overflow: hidden;
}

.scg-main-heading {
  font-size: clamp(2.5rem, 6vw, 4.5rem);
  font-weight: 900;
  margin: 0 0 15px 0;
  letter-spacing: -0.5px;
  line-height: 1;
  text-transform: uppercase;
  position: relative;
  font-family: 'Inter', sans-serif;
  /* Default gradient - will be overridden if custom color is set */
  background: linear-gradient(90deg, 
    #ff3366 0%, 
    #ff9933 25%, 
    #33ff66 50%, 
    #3366ff 75%, 
    #cc33ff 100%);
  background-size: 300% 300%;
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  animation: gradient-shift 4s ease infinite, 
             text-glow 2s ease-in-out infinite alternate;
  text-shadow: 0 0 30px rgba(255, 51, 102, 0.3);
}

/* If custom color is set, disable gradient animation */
.scg-main-heading[style*="color:"] {
  animation: none;
  text-shadow: none;
}

@keyframes gradient-shift {
  0%, 100% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
}

@keyframes text-glow {
  from { text-shadow: 0 0 30px rgba(255, 51, 102, 0.3), 
                      0 0 60px rgba(51, 102, 255, 0.2); }
  to { text-shadow: 0 0 40px rgba(255, 51, 102, 0.5), 
                    0 0 80px rgba(51, 102, 255, 0.3),
                    0 0 100px rgba(204, 51, 255, 0.2); }
}

.scg-main-heading::before,
.scg-main-heading::after {
  content: 'âœ¦';
  position: absolute;
  top: 50%;
  transform: translateY(-50%);
  font-size: 1.8rem;
  opacity: 0.7;
  animation: sparkle 2s infinite;
}

.scg-main-heading::before {
  left: -50px;
  animation-delay: 0.5s;
}

.scg-main-heading::after {
  right: -50px;
  animation-delay: 1s;
}

@keyframes sparkle {
  0%, 100% { opacity: 0.3; transform: translateY(-50%) scale(0.8); }
  50% { opacity: 1; transform: translateY(-50%) scale(1.2); }
}

.scg-subheading {
  font-size: clamp(1.1rem, 2.5vw, 1.4rem);
  color: #111; /* Solid dark color */
  margin: 0;
  font-weight: 600;
  letter-spacing: 2px;
  text-transform: uppercase;
  position: relative;
  display: inline-block;
  padding: 10px 25px;
  border: 1px solid rgba(255,255,255,0.3);
  border-radius: 50px;
  background: rgba(255, 255, 255, 0.9);
  backdrop-filter: blur(10px);
  box-shadow: 
    0 8px 32px rgba(0, 0, 0, 0.2),
    0 0 20px rgba(255, 255, 255, 0.5) inset;
  text-shadow: 0 3px 5px rgba(255, 255, 255, 0.8);
  animation: pulse-border 3s infinite;
}

@keyframes pulse-border {
  0%, 100% { border-color: rgba(255,255,255,0.3); }
  50% { border-color: rgba(255, 51, 102, 0.6); }
}

/* Decorative background elements */
.scg-heading-wrapper::before {
  content: '';
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 400px;
  height: 400px;
  background: radial-gradient(circle, 
    rgba(255,51,102,0.1) 0%,
    rgba(51,102,255,0.05) 40%,
    transparent 70%);
  z-index: -1;
  animation: pulse 6s ease-in-out infinite;
}

@keyframes pulse {
  0%, 100% { opacity: 0.5; transform: translate(-50%, -50%) scale(0.8); }
  50% { opacity: 0.8; transform: translate(-50%, -50%) scale(1.2); }
}

.scg-{{ sid }}__wrap {
  padding-top: 0 !important;
  position: relative;
  z-index: 2;
}

/* ===== AGE FILTER STYLES ===== */
.scg-age-filter {
  margin-top: {{ age_filter_margin_top }}px;
  margin-bottom: {{ age_filter_margin_bottom }}px;
  text-align: center;
}

.scg-age-filter__title {
  font-size: 16px;
  font-weight: 600;
  color: #4a4a4a;
  margin: 0 0 16px 0;
  text-transform: none;
  letter-spacing: 0;
}

.scg-age-filter__buttons {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 12px;
  flex-wrap: wrap;
}

.scg-age-filter__btn {
  padding: 12px 24px;
  background: #4a4a4a;
  color: #ffffff;
  border: none;
  border-radius: 8px;
  font-size: 14px;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.3s ease;
  min-width: 140px;
  text-align: center;
}

.scg-age-filter__btn:hover {
  background: #333333;
  transform: translateY(-1px);
}

.scg-age-filter__btn.scg-age-filter__btn--active {
  background: #2a2a2a;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
}

.scg-age-filter__reset {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  background: #4a4a4a;
  color: #ffffff;
  border: none;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.3s ease;
  padding: 0;
  flex-shrink: 0;
}

.scg-age-filter__reset:hover {
  background: #333333;
  transform: rotate(90deg);
}

.scg-age-filter__reset svg {
  width: 18px;
  height: 18px;
}

@media (max-width: 768px) {
  .scg-age-filter__buttons {
    gap: 10px;
  }
  
  .scg-age-filter__btn {
    min-width: 120px;
    padding: 10px 20px;
    font-size: 13px;
  }
  
  .scg-age-filter__reset {
    width: 36px;
    height: 36px;
  }
}
/* ===== END AGE FILTER STYLES ===== */

/* ===== AGE FILTER FUNCTIONALITY ===== */
.scg-{{ sid }}__tile,
.scg-carousel__slide {
  transition: opacity 0.3s ease, transform 0.3s ease, visibility 0.3s ease;
}

/* Filtered items remain visible but inactive */
.scg-{{ sid }}__tile.scg-filtered-out,
.scg-carousel__slide.scg-filtered-out {
  opacity: 0.55;
  transform: scale(0.985);
  pointer-events: none;
}

/* Desktop: filtered tiles stay blurred/dimmed */
.scg-{{ sid }}__tile.scg-filtered-out .scg-{{ sid }}__media img {
  filter: blur(var(--scg-blur));
  transform: scale({{ section.settings.image_scale | divided_by: 100.0 }});
}

/* Prevent filtered tiles from becoming active */
.scg-{{ sid }}__tile.scg-filtered-out.scg-is-active {
  transform: scale(0.985);
  opacity: 0.55;
}

.scg-{{ sid }}__tile.scg-filtered-out .scg-{{ sid }}__hover-text {
  opacity: 0;
}

.scg-{{ sid }}__wrap.scg-filtering {
  min-height: auto;
}
/* ===== END AGE FILTER FUNCTIONALITY ===== */

/* ===== END GAMING STYLE ===== */
  #shopify-section-{{ section.id }},
  #shopify-section-{{ section.id }} *{
    box-sizing:border-box;
  }
  #shopify-section-{{ section.id }}{
    background: {{ section.settings.section_bg }} !important;
    margin: {{ section_margin_top }}px 0 {{ section_margin_bottom }}px 0 !important;
    padding: {{ section_padding_top }}px {{ section_padding_right }}px {{ section_padding_bottom }}px {{ section_padding_left }}px !important;
  }
  #shopify-section-{{ section.id }} .page-width{
    max-width:none !important;
    padding:0 !important;
  }
  #shopify-section-{{ section.id }} .gradient,
  #shopify-section-{{ section.id }} .color-background-1,
  #shopify-section-{{ section.id }} .color-background-2{
    background: transparent !important;
  }

  /* section */
  .scg-{{ sid }}{
    width:100%;
    background: {{ section.settings.section_bg }};
    margin:0;
    padding:0;
    --scg-blur: 3px;
  }

  /* grid centered in the section */
  .scg-{{ sid }}__wrap{
    width:100%;
    max-width:{{ section.settings.max_width }}px;
    margin:0 auto;
    padding:{{ grid_wrap_padding_top }}px {{ grid_wrap_padding_right }}px {{ grid_wrap_padding_bottom }}px {{ grid_wrap_padding_left }}px;
    min-height:{{ section.settings.height_vh }}vh;
    display:grid;
    grid-template-columns:repeat({{ section.settings.columns }}, minmax(0,1fr));
    gap:{{ section.settings.gap }}px;
    align-content:center;
  }

  /* allow hover in editor */
  .scg-{{ sid }}__tile,.scg-{{ sid }}__tile *{pointer-events:auto}
  .scg-{{ sid }}__tile .shopify-section,
  .scg-{{ sid }}__tile [data-shopify-editor-section],
  .scg-{{ sid }}__tile [data-shopify-editor-block],
  .scg-{{ sid }}__tile .shopify-block,
  .scg-{{ sid }}__tile .shopify-section__block{pointer-events:none}

  /* tiles */
  .scg-{{ sid }}__tile{
    position:relative;
    overflow:hidden;
    display:block;
    text-decoration:none;
    height:{{ section.settings.tile_h }}px;
    border-radius:{{ section.settings.radius }}px;
    box-shadow:0 18px 45px rgba(0,0,0,.14);
    transition:filter .35s ease,opacity .35s ease,transform .35s ease;
    background: {{ section.settings.tile_bg }};
  }

  /* media fills tile */
  .scg-{{ sid }}__media{
    position:absolute;
    inset:0;
    z-index:0;
  }
  .scg-{{ sid }}__media img{
    width:100%;
    height:100%;
    display:block;
    object-fit:{{ section.settings.image_fit }};
    object-position:{{ section.settings.image_pos_x }}% {{ section.settings.image_pos_y }}%;
    transform:scale({{ section.settings.image_scale | divided_by: 100.0 }});
    transition:transform .5s ease;
  }

  /* overlay */
  .scg-{{ sid }}__overlay{
    position:absolute;inset:0;z-index:1;
    background:linear-gradient(
      180deg,
      rgba(0,0,0,0) 20%,
      rgba(0,0,0,{{ section.settings.overlay_opacity | divided_by: 100.0 }}) 100%
    );
    opacity:{{ section.settings.overlay_opacity | divided_by: 100.0 }};
    transition:opacity .35s ease;
  }

  /* hover vertical text */
  .scg-{{ sid }}__hover-text{
    position:absolute;
    right:18px;
    bottom:18px;
    writing-mode:vertical-rl;
    transform:rotate(180deg);
    font-size:22px;
    font-weight:900;
    letter-spacing:2px;
    color:var(--scg-text);
    opacity:0;
    transition:opacity .3s ease;
    z-index:3;
    pointer-events:none;
  }

  /* === Smooth hover system (no :has) === */
  .scg-{{ sid }}__wrap {
    /* helps isolate paint work */
    contain: layout paint style;
  }

  .scg-{{ sid }}__tile {
    will-change: transform, opacity;
    transform: translateZ(0);
    backface-visibility: hidden;
  }

  .scg-{{ sid }}__media {
    will-change: transform;
    transform: translateZ(0);
  }

  .scg-{{ sid }}__media img {
    will-change: transform;
    transform: translateZ(0);
  }

  /* Active tile hover effects */
  .scg-{{ sid }}__tile.scg-is-active .scg-{{ sid }}__hover-text{opacity:1}
  .scg-{{ sid }}__tile.scg-is-active .scg-{{ sid }}__overlay{opacity:{{ section.settings.overlay_hover_opacity | divided_by: 100.0 }}}
  .scg-{{ sid }}__tile.scg-is-active .scg-{{ sid }}__media img{
    transform:scale({{ section.settings.image_scale | divided_by: 100.0 }}) scale({{ section.settings.hover_zoom | divided_by: 100.0 }});
  }

  /* When hovering any tile (JS adds .scg-is-hovering on wrap) */
  .scg-{{ sid }}__wrap.scg-is-hovering .scg-{{ sid }}__tile {
    opacity: 0.55;
    transform: translateZ(0) scale(0.985);
  }

  /* Blur ONLY the image layer of non-active tiles (much faster than blurring the whole card) */
  .scg-{{ sid }}__wrap.scg-is-hovering .scg-{{ sid }}__tile:not(.scg-is-active) .scg-{{ sid }}__media img {
    filter: blur(var(--scg-blur));
  }

  /* Active tile pops */
  .scg-{{ sid }}__wrap.scg-is-hovering .scg-{{ sid }}__tile.scg-is-active {
    opacity: 1;
    transform: translateY(-14px) scale(1.03) translateZ(0);
    z-index: 3;
  }

  /* Show hover text only on active tile */
  .scg-{{ sid }}__wrap.scg-is-hovering .scg-{{ sid }}__tile:not(.scg-is-active) .scg-{{ sid }}__hover-text {
    opacity: 0;
  }
  .scg-{{ sid }}__wrap.scg-is-hovering .scg-{{ sid }}__tile.scg-is-active .scg-{{ sid }}__hover-text {
    opacity: 1;
  }

  /* Optional: reduce motion for accessibility */
  @media (prefers-reduced-motion: reduce) {
    .scg-{{ sid }}__tile,
    .scg-{{ sid }}__media img {
      transition: none !important;
    }
    .scg-{{ sid }}__wrap.scg-is-hovering .scg-{{ sid }}__tile:not(.scg-is-active) .scg-{{ sid }}__media img {
      filter: none !important;
    }
  }

  /* Disable blur interaction on touch devices (no hover) */
  @media (hover: none) {
    .scg-{{ sid }}__wrap.scg-is-hovering .scg-{{ sid }}__tile {
      opacity: 1;
      transform: none;
    }
    .scg-{{ sid }}__wrap.scg-is-hovering .scg-{{ sid }}__tile:not(.scg-is-active) .scg-{{ sid }}__media img {
      filter: none;
    }
  }

    /* ===== MOBILE CAROUSEL - HIDDEN BY DEFAULT ===== */
.scg-mobile-carousel {
  display: none; /* Hidden on desktop */
  width: 100%;
  overflow: hidden;
  position: relative;
  padding: {{ mobile_carousel_padding_top }}px {{ mobile_carousel_padding_right }}px {{ mobile_carousel_padding_bottom }}px {{ mobile_carousel_padding_left }}px;
}

.scg-carousel__container {
  display: flex;
  transition: transform 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
  gap: 0;
  padding: 0;
  width: 100%;
  -webkit-overflow-scrolling: touch; /* Better mobile scrolling */
}
.scg-carousel__container * {
  -webkit-backface-visibility: hidden;
  backface-visibility: hidden;
}

.scg-carousel__slide {
  flex: 0 0 100%;
  min-width: 100%;
  flex-shrink: 0;
  will-change: transform; /* Optimize animations */
}

.scg-carousel__link {
  position: relative;
  display: block;
  margin: 0 15px;
  height: {{ section.settings.tile_h_mobile }}px;
  text-decoration: none;
  border-radius: {{ section.settings.radius }}px;
  box-shadow: 0 10px 30px rgba(0,0,0,.2);
  background: {{ section.settings.tile_bg }};
  overflow: hidden;
}


.scg-carousel__media {
  position: absolute;
  inset: 0;
  z-index: 0;
}

.scg-carousel__media img {
  width: 100% !important;
  height: 100% !important;
  display: block !important;
  object-fit: cover !important;
  object-position: center 30% !important; /* Focus on top part of image */
  background: {{ section.settings.tile_bg }};
  transition: transform 0.5s ease;
}

.scg-carousel__link:hover .scg-carousel__media img {
  transform: scale(1.05);
}

.scg-carousel__overlay {
  position: absolute;
  inset: 0;
  z-index: 1;
  background: linear-gradient(
    180deg,
    rgba(0,0,0,0) 20%,
    rgba(0,0,0,0.6) 100%
  );
}

.scg-carousel__title {
  position: absolute;
  bottom: 20px;
  left: 20px;
  right: 20px;
  font-size: 18px;
  font-weight: 700;
  color: #fff;
  z-index: 3;
  text-align: center;
  text-shadow: 0 2px 4px rgba(0,0,0,0.5);
}

.scg-carousel__dots {
  display: flex;
  justify-content: center;
  gap: 8px;
  margin-top: 20px;
}

.scg-carousel__dot {
  width: 10px;
  height: 10px;
  border-radius: 50%;
  background: rgba(0,0,0,0.2);
  cursor: pointer;
  transition: background 0.3s ease;
}

.scg-carousel__dot.active {
  background: #ff3366;
  transform: scale(1.2);
}

  @media (max-width:989px){
  /* HIDE the desktop grid on mobile */
  .scg-{{ sid }}__wrap {
    display: none !important;
  }
  
  /* SHOW the mobile carousel on mobile */
  .scg-mobile-carousel {
    display: block !important;
  }
  
  /* Hover effects disabled on mobile via @media (hover: none) rule above */
}


{% endstyle %}

<section class="scg-{{ sid }}">
  <div class="scg-heading-wrapper">
    <h2 class="scg-main-heading" style="{% if section.settings.heading_color != blank %}color: {{ section.settings.heading_color }}; background: none; -webkit-background-clip: unset; -webkit-text-fill-color: {{ section.settings.heading_color }}; background-clip: unset;{% endif %}">
      {{ section.settings.heading_text | default: "Choose Your Character" }}
    </h2>
    
    <!-- Age Filter System -->
    <div class="scg-age-filter">
      <h3 class="scg-age-filter__title">{{ section.settings.filter_title | default: "Select your Age" }}</h3>
      <div class="scg-age-filter__buttons">
        {%- if section.settings.filter_button_1_text != blank -%}
          <button 
            type="button" 
            class="scg-age-filter__btn" 
            data-age-range="{{ section.settings.filter_button_1_range | default: '0.5-4' }}"
            aria-label="{{ section.settings.filter_button_1_text }}"
          >
            {{ section.settings.filter_button_1_text }}
          </button>
        {%- endif -%}
        {%- if section.settings.filter_button_2_text != blank -%}
          <button 
            type="button" 
            class="scg-age-filter__btn" 
            data-age-range="{{ section.settings.filter_button_2_range | default: '4-7' }}"
            aria-label="{{ section.settings.filter_button_2_text }}"
          >
            {{ section.settings.filter_button_2_text }}
          </button>
        {%- endif -%}
        {%- if section.settings.filter_button_3_text != blank -%}
          <button 
            type="button" 
            class="scg-age-filter__btn" 
            data-age-range="{{ section.settings.filter_button_3_range | default: 'all' }}"
            aria-label="{{ section.settings.filter_button_3_text }}"
          >
            {{ section.settings.filter_button_3_text }}
          </button>
        {%- endif -%}
        <button 
          type="button" 
          class="scg-age-filter__reset" 
          aria-label="Reset age filter"
          title="Reset filter"
        >
          <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M10 3V1M10 3C7.239 3 5 5.239 5 8C5 10.761 7.239 13 10 13C12.761 13 15 10.761 15 8M10 3L12 1M10 3L8 1M15 8V10M15 8H17M15 8H13" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </button>
      </div>
    </div>
  </div>

  {% comment %} Mobile View {% endcomment %}

  <!-- ADD THIS NEW MOBILE-ONLY CAROUSEL -->
<div class="scg-mobile-carousel">
  <div class="scg-carousel__container">
    {% for block in section.blocks %}
      {% assign p = block.settings.product %}
      {% assign img = block.settings.custom_image %}
      {% if p %}
        {%- liquid
          comment
            Support multiple age ranges: comma-separated values like "0.5-4,5-7" or "all"
            Normalize by converting to lowercase and trimming
          endcomment
          assign age_ranges_raw = block.settings.age_range | default: 'all'
          assign age_ranges = age_ranges_raw | downcase | strip
          comment
            Liquid doesn't support map with strip, so we'll store as-is and let JS handle trimming
            The data attribute will contain comma-separated values
          endcomment
        -%}
        <div class="scg-carousel__slide" data-age-range="{{ age_ranges }}">
          <a
            href="{{ p.url }}"
            class="scg-carousel__link"
            style="--scg-text: {{ block.settings.text_color }};"
            {{ block.shopify_attributes }}
          >
            <div class="scg-carousel__media">
              {% if img %}
                <img src="{{ img | image_url: width: 800 }}" loading="lazy" decoding="async" alt="{{ p.title }}">
              {% elsif p.featured_image %}
                <img src="{{ p.featured_image | image_url: width: 800 }}" loading="lazy" decoding="async" alt="{{ p.title }}">
              {% endif %}
            </div>
            <div class="scg-carousel__overlay"></div>
            <span class="scg-carousel__title">
              {% if p.metafields.custom.pgc_middle_text and p.metafields.custom.pgc_middle_text.value != blank %}
                {{ p.metafields.custom.pgc_middle_text.value }}
              {% else %}
                {{ p.title }}
              {% endif %}
            </span>
          </a>
        </div>
      {% endif %}
    {% endfor %}
  </div>
  <div class="scg-carousel__dots"></div>
</div>

  {% comment %} Desktop View {% endcomment %}
  <div class="scg-{{ sid }}__wrap">
    {% for block in section.blocks %}
      {% assign p = block.settings.product %}
      {% assign img = block.settings.custom_image %}
      {% if p %}
        <a
          href="{{ p.url }}"
          class="scg-{{ sid }}__tile"
          style="--scg-text: {{ block.settings.text_color }};"
          {%- liquid
            comment
              Support multiple age ranges: comma-separated values like "0.5-4,5-7" or "all"
              Normalize by converting to lowercase and trimming
            endcomment
            assign age_ranges_raw = block.settings.age_range | default: 'all'
            assign age_ranges = age_ranges_raw | downcase | strip
            comment
              Liquid doesn't support map with strip, so we'll store as-is and let JS handle trimming
              The data attribute will contain comma-separated values
            endcomment
          -%}
          data-age-range="{{ age_ranges }}"
          {{ block.shopify_attributes }}
        >
          <div class="scg-{{ sid }}__media" aria-hidden="true">
            {% if img %}
              {{ img | image_url: width: 1200 | image_tag: widths: '400,600,800,1000,1200', sizes: '(min-width: 990px) 20vw, 100vw', loading: 'lazy', decoding: 'async', alt: '' }}
            {% elsif p.featured_image %}
              {{ p.featured_image | image_url: width: 1200 | image_tag: widths: '400,600,800,1000,1200', sizes: '(min-width: 990px) 20vw, 100vw', loading: 'lazy', decoding: 'async', alt: '' }}
            {% endif %}
          </div>

          <div class="scg-{{ sid }}__overlay" aria-hidden="true"></div>

          <span class="scg-{{ sid }}__hover-text">
            {% if p.metafields.custom.pgc_middle_text and p.metafields.custom.pgc_middle_text.value != blank %}
              {{ p.metafields.custom.pgc_middle_text.value }}
            {% else %}
              {{ p.title }}
            {% endif %}
          </span>
        </a>
      {% endif %}
    {% endfor %}
  </div>
  <script>
document.addEventListener('DOMContentLoaded', function() {
  const carousel = document.querySelector('.scg-mobile-carousel');
  if (!carousel) return;
  
  const isMobile = window.matchMedia('(max-width: 989px)').matches;
  if (!isMobile) return;
  
  const container = carousel.querySelector('.scg-carousel__container');
  const slides = carousel.querySelectorAll('.scg-carousel__slide');
  const dotsContainer = carousel.querySelector('.scg-carousel__dots');
  
  if (!slides.length || slides.length < 2) return;
  
  let currentIndex = 0;
  let startX = 0;
  let currentX = 0;
  let isDragging = false;
  let autoSlideInterval;
  let isAnimating = false;
  
  // Create dots
  dotsContainer.innerHTML = '';
  slides.forEach((_, index) => {
    const dot = document.createElement('div');
    dot.className = 'scg-carousel__dot';
    if (index === 0) dot.classList.add('active');
    dot.addEventListener('click', () => goToSlide(index));
    dotsContainer.appendChild(dot);
  });
  
  function updateCarousel(instant = false, targetIndex = null) {
    if (isAnimating && !instant) return;
    
    const slideWidth = slides[0].offsetWidth;
    const effectiveIndex = targetIndex !== null ? targetIndex : currentIndex;
    
    if (!instant) isAnimating = true;
    
    container.style.transition = instant ? 'none' : 'transform 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94)';
    container.style.transform = `translateX(-${effectiveIndex * slideWidth}px)`;
    
    // Update dots with actual currentIndex (not effectiveIndex for edge cases)
    dotsContainer.querySelectorAll('.scg-carousel__dot').forEach((dot, index) => {
      dot.classList.toggle('active', index === currentIndex);
    });
    
    // Reset animation flag
    if (!instant) {
      setTimeout(() => {
        isAnimating = false;
        
        // Handle edge jumps AFTER animation completes
        if (effectiveIndex === -1) {
          // Special case: showing "clone" of last before first
          container.style.transition = 'none';
          container.style.transform = `translateX(-${(slides.length - 1) * slideWidth}px)`;
          currentIndex = slides.length - 1;
          updateCarousel(true); // Update dots immediately
        } else if (effectiveIndex === slides.length) {
          // Special case: showing "clone" of first after last
          container.style.transition = 'none';
          container.style.transform = `translateX(0px)`;
          currentIndex = 0;
          updateCarousel(true); // Update dots immediately
        }
      }, 500);
    }
  }
  
  function goToSlide(index, instant = false) {
    if (isAnimating && !instant) return;
    
    currentIndex = index;
    
    // Handle infinite edges
    if (index < 0) {
      // Going left from first: show "clone" of last at position -1
      const slideWidth = slides[0].offsetWidth;
      container.style.transition = 'transform 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94)';
      container.style.transform = `translateX(${slideWidth}px)`; // Shows last slide to the right
      currentIndex = slides.length - 1; // Will update after animation
      updateCarousel(false, -1); // Animate to position -1
    } else if (index >= slides.length) {
      // Going right from last: show "clone" of first at position length
      const slideWidth = slides[0].offsetWidth;
      container.style.transition = 'transform 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94)';
      container.style.transform = `translateX(-${(slides.length - 1) * slideWidth}px)`; // Shows first slide to the left
      currentIndex = 0; // Will update after animation
      updateCarousel(false, slides.length); // Animate to position length
    } else {
      // Normal movement
      updateCarousel(instant);
    }
  }
  
  function nextSlide() {
    goToSlide(currentIndex + 1);
  }
  
  function prevSlide() {
    goToSlide(currentIndex - 1);
  }
  
  // SWIPE HANDLING - SIMPLIFIED
  container.addEventListener('touchstart', (e) => {
    if (isAnimating) return;
    startX = e.touches[0].clientX;
    isDragging = true;
    container.style.transition = 'none';
    clearInterval(autoSlideInterval);
  });
  
  container.addEventListener('touchmove', (e) => {
    if (!isDragging || isAnimating) return;
    e.preventDefault();
    
    const x = e.touches[0].clientX;
    const diff = x - startX;
    const slideWidth = slides[0].offsetWidth;
    
    // Calculate drag position with bounds
    let dragOffset = (-currentIndex * slideWidth) + diff;
    
    // Allow slight overflow for infinite feel (50px)
    const minDrag = -((slides.length) * slideWidth) + 50;
    const maxDrag = 50;
    
    if (dragOffset > maxDrag) dragOffset = maxDrag;
    if (dragOffset < minDrag) dragOffset = minDrag;
    
    container.style.transform = `translateX(${dragOffset}px)`;
  });
  
  container.addEventListener('touchend', (e) => {
    if (!isDragging || isAnimating) return;
    isDragging = false;
    
    const endX = e.changedTouches[0].clientX;
    const diff = startX - endX;
    const slideWidth = slides[0].offsetWidth;
    const threshold = slideWidth * 0.2; // 20% threshold
    
    if (Math.abs(diff) > threshold) {
      if (diff > 0) {
        // Swipe left = next
        nextSlide();
      } else {
        // Swipe right = previous
        prevSlide();
      }
    } else {
      // Not enough swipe, snap back
      updateCarousel();
    }
    
    startAutoSlide();
  });
  
  // Add CSS for smoother edges
  const style = document.createElement('style');
  style.textContent = `
    .scg-carousel__container {
      -webkit-overflow-scrolling: touch;
      scrollbar-width: none;
    }
    .scg-carousel__container::-webkit-scrollbar {
      display: none;
    }
  `;
  document.head.appendChild(style);
  
  function startAutoSlide() {
    clearInterval(autoSlideInterval);
    autoSlideInterval = setInterval(() => {
      if (!isDragging && !isAnimating) {
        nextSlide();
      }
    }, 5000);
  }
  
  // Pause on hover
  container.addEventListener('mouseenter', () => clearInterval(autoSlideInterval));
  container.addEventListener('mouseleave', startAutoSlide);
  
  // Initialize
  updateCarousel(true);
  startAutoSlide();
  
  // Handle resize
  window.addEventListener('resize', function() {
    if (window.matchMedia('(max-width: 989px)').matches) {
      updateCarousel(true);
    }
  });

  // Handle filter updates - filtered slides remain visible but inactive
  carousel.addEventListener('scg-filter-updated', function() {
    // If current slide is filtered, move to first non-filtered slide
    if (slides[currentIndex] && slides[currentIndex].classList.contains('scg-filtered-out')) {
      const firstVisibleIndex = Array.from(slides).findIndex(slide => !slide.classList.contains('scg-filtered-out'));
      if (firstVisibleIndex >= 0) {
        currentIndex = firstVisibleIndex;
        updateCarousel(true);
      }
    }
    
    // Dots always represent all slides (filtered items remain visible)
    // No need to recreate dots - they already represent all slides
  });
});
</script>

<script>
(function() {
  const wrap = document.querySelector('.scg-{{ sid }}__wrap');
  if (!wrap) return;

  const tiles = Array.from(wrap.querySelectorAll('.scg-{{ sid }}__tile'));
  if (!tiles.length) return;

  let raf = null;
  let hoverTimeout = null;
  let currentActiveTile = null;

  function setActive(tile) {
    // Ignore filtered-out tiles
    if (tile.classList.contains('scg-filtered-out')) {
      return;
    }

    if (raf) cancelAnimationFrame(raf);
    raf = requestAnimationFrame(() => {
      wrap.classList.add('scg-is-hovering');
      tiles.forEach(t => t.classList.toggle('scg-is-active', t === tile));
      currentActiveTile = tile;
    });
  }

  function clearActive() {
    if (raf) cancelAnimationFrame(raf);
    raf = requestAnimationFrame(() => {
      wrap.classList.remove('scg-is-hovering');
      tiles.forEach(t => t.classList.remove('scg-is-active'));
      currentActiveTile = null;
    });
  }

  tiles.forEach(tile => {
    tile.addEventListener('pointerenter', () => {
      // Clear any pending timeout
      if (hoverTimeout) {
        clearTimeout(hoverTimeout);
        hoverTimeout = null;
      }

      // Add 60ms hover-intent delay
      hoverTimeout = setTimeout(() => {
        setActive(tile);
      }, 60);
    }, { passive: true });

    tile.addEventListener('pointerleave', () => {
      // Clear hover timeout if pointer leaves before delay
      if (hoverTimeout) {
        clearTimeout(hoverTimeout);
        hoverTimeout = null;
      }
      // leave handled by wrap pointerleave for stability
    }, { passive: true });
  });

  wrap.addEventListener('pointerleave', () => {
    // Clear hover timeout
    if (hoverTimeout) {
      clearTimeout(hoverTimeout);
      hoverTimeout = null;
    }
    clearActive();
  }, { passive: true });

  // Theme editor safety: rebind on section load
  document.addEventListener('shopify:section:load', (e) => {
    // nothing required here unless you want to fully re-init; this is usually enough since section reloads DOM
  });
})();
</script>

<script>
// Age Filter Functionality
(function() {
  const ageFilter = document.querySelector('.scg-age-filter');
  if (!ageFilter) return;

  const filterButtons = ageFilter.querySelectorAll('.scg-age-filter__btn');
  const resetButton = ageFilter.querySelector('.scg-age-filter__reset');
  const desktopTiles = document.querySelectorAll('.scg-{{ sid }}__tile');
  const mobileSlides = document.querySelectorAll('.scg-carousel__slide');
  const desktopWrap = document.querySelector('.scg-{{ sid }}__wrap');
  const mobileCarousel = document.querySelector('.scg-mobile-carousel');

  let currentFilter = null;

  function filterByAge(ageRange) {
    currentFilter = ageRange;
    
    // Update button states
    filterButtons.forEach(btn => {
      if (btn.dataset.ageRange === ageRange) {
        btn.classList.add('scg-age-filter__btn--active');
      } else {
        btn.classList.remove('scg-age-filter__btn--active');
      }
    });

    // Filter desktop tiles (add/remove scg-filtered-out class)
    // Support multiple age ranges per tile (comma-separated)
    desktopTiles.forEach(tile => {
      const tileAgeRanges = (tile.dataset.ageRange || 'all').toLowerCase().trim();
      const tileAgeArray = tileAgeRanges.split(',').map(r => r.trim());
      
      let shouldShow = false;
      if (ageRange === 'all') {
        shouldShow = true;
      } else if (tileAgeArray.includes('all')) {
        shouldShow = true; // "all" always shows
      } else {
        // Check if any of the tile's age ranges match the filter
        shouldShow = tileAgeArray.includes(ageRange.toLowerCase().trim());
      }
      
      if (shouldShow) {
        tile.classList.remove('scg-filtered-out');
      } else {
        tile.classList.add('scg-filtered-out');
      }
    });

    // Filter mobile carousel slides (add/remove scg-filtered-out class)
    // Support multiple age ranges per slide (comma-separated)
    mobileSlides.forEach(slide => {
      const slideAgeRanges = (slide.dataset.ageRange || 'all').toLowerCase().trim();
      const slideAgeArray = slideAgeRanges.split(',').map(r => r.trim());
      
      let shouldShow = false;
      if (ageRange === 'all') {
        shouldShow = true;
      } else if (slideAgeArray.includes('all')) {
        shouldShow = true; // "all" always shows
      } else {
        // Check if any of the slide's age ranges match the filter
        shouldShow = slideAgeArray.includes(ageRange.toLowerCase().trim());
      }
      
      if (shouldShow) {
        slide.classList.remove('scg-filtered-out');
      } else {
        slide.classList.add('scg-filtered-out');
      }
    });

    // Clear active state if currently active tile becomes filtered
    const desktopWrap = document.querySelector('.scg-{{ sid }}__wrap');
    if (desktopWrap) {
      const activeTile = desktopWrap.querySelector('.scg-{{ sid }}__tile.scg-is-active');
      if (activeTile && activeTile.classList.contains('scg-filtered-out')) {
        desktopWrap.classList.remove('scg-is-hovering');
        activeTile.classList.remove('scg-is-active');
      }
    }

    // Update carousel if on mobile
    if (mobileCarousel && window.matchMedia('(max-width: 989px)').matches) {
      // Trigger carousel update if needed
      const carouselUpdateEvent = new Event('scg-filter-updated');
      mobileCarousel.dispatchEvent(carouselUpdateEvent);
    }
  }

  function resetFilter() {
    currentFilter = null;
    
    // Remove active state from all buttons
    filterButtons.forEach(btn => {
      btn.classList.remove('scg-age-filter__btn--active');
    });

    // Show all tiles
    desktopTiles.forEach(tile => {
      tile.classList.remove('scg-filtered-out');
    });

    // Show all mobile slides
    mobileSlides.forEach(slide => {
      slide.classList.remove('scg-filtered-out');
    });
  }

  // Add click handlers to filter buttons
  filterButtons.forEach(btn => {
    btn.addEventListener('click', () => {
      const ageRange = btn.dataset.ageRange;
      if (currentFilter === ageRange) {
        // Clicking same button resets filter
        resetFilter();
      } else {
        filterByAge(ageRange);
      }
    });
  });

  // Add click handler to reset button
  if (resetButton) {
    resetButton.addEventListener('click', resetFilter);
  }
})();
</script>
</section>

{% schema %}
{
  "name": "Shop color grid",
  "tag": "section",
  "settings": [
    {
      "type": "header",
      "content": "Content Settings"
    },
    {
      "type": "header",
      "content": "Heading"
    },
    {
      "type": "text",
      "id": "heading_text",
      "label": "Heading Text",
      "default": "Choose Your Character"
    },
    {
      "type": "color",
      "id": "heading_color",
      "label": "Heading Color",
      "info": "Leave blank to use animated gradient. Set a color to use solid color instead."
    },
    {
      "type": "header",
      "content": "Age Filter"
    },
    {
      "type": "text",
      "id": "filter_title",
      "label": "Filter Title",
      "default": "Select your Age"
    },
    {
      "type": "header",
      "content": "Filter Button 1"
    },
    {
      "type": "text",
      "id": "filter_button_1_text",
      "label": "Button 1 Text",
      "default": "0.5 - 4 Years"
    },
    {
      "type": "text",
      "id": "filter_button_1_range",
      "label": "Button 1 Age Range",
      "default": "0.5-4",
      "info": "Enter the age range value (e.g., '0.5-4', '4-7', 'all'). This must match the age range set on product tiles."
    },
    {
      "type": "header",
      "content": "Filter Button 2"
    },
    {
      "type": "text",
      "id": "filter_button_2_text",
      "label": "Button 2 Text",
      "default": "4 - 7 Years"
    },
    {
      "type": "text",
      "id": "filter_button_2_range",
      "label": "Button 2 Age Range",
      "default": "4-7",
      "info": "Enter the age range value (e.g., '0.5-4', '4-7', 'all'). This must match the age range set on product tiles."
    },
    {
      "type": "header",
      "content": "Filter Button 3 (Optional)"
    },
    {
      "type": "text",
      "id": "filter_button_3_text",
      "label": "Button 3 Text",
      "info": "Leave blank to hide this button"
    },
    {
      "type": "text",
      "id": "filter_button_3_range",
      "label": "Button 3 Age Range",
      "default": "all",
      "info": "Enter the age range value (e.g., '0.5-4', '4-7', 'all'). This must match the age range set on product tiles."
    },
    {
      "type": "header",
      "content": "Layout Settings"
    },
    { "type": "color", "id": "section_bg", "label": "Section background", "default": "#ffffff" },
    {
      "type": "header",
      "content": "Section Padding & Margin"
    },
    {
      "type": "range",
      "id": "section_padding_top",
      "min": 0,
      "max": 200,
      "step": 4,
      "unit": "px",
      "label": "Section Padding Top",
      "default": 0,
      "info": "Controls the top padding of the entire section"
    },
    {
      "type": "range",
      "id": "section_padding_bottom",
      "min": 0,
      "max": 200,
      "step": 4,
      "unit": "px",
      "label": "Section Padding Bottom",
      "default": 0,
      "info": "Controls the bottom padding of the entire section"
    },
    {
      "type": "range",
      "id": "section_padding_left",
      "min": 0,
      "max": 200,
      "step": 4,
      "unit": "px",
      "label": "Section Padding Left",
      "default": 0,
      "info": "Controls the left padding of the entire section"
    },
    {
      "type": "range",
      "id": "section_padding_right",
      "min": 0,
      "max": 200,
      "step": 4,
      "unit": "px",
      "label": "Section Padding Right",
      "default": 0,
      "info": "Controls the right padding of the entire section"
    },
    {
      "type": "range",
      "id": "section_margin_top",
      "min": 0,
      "max": 200,
      "step": 4,
      "unit": "px",
      "label": "Section Margin Top",
      "default": 0,
      "info": "Controls the top margin (space above) the entire section"
    },
    {
      "type": "range",
      "id": "section_margin_bottom",
      "min": 0,
      "max": 200,
      "step": 4,
      "unit": "px",
      "label": "Section Margin Bottom",
      "default": 0,
      "info": "Controls the bottom margin (space below) the entire section"
    },
    {
      "type": "header",
      "content": "Heading Area Padding"
    },
    {
      "type": "range",
      "id": "heading_padding_top",
      "min": 0,
      "max": 100,
      "step": 2,
      "unit": "px",
      "label": "Heading Padding Top",
      "default": 0,
      "info": "Controls the top padding around the heading text area"
    },
    {
      "type": "range",
      "id": "heading_padding_bottom",
      "min": 0,
      "max": 100,
      "step": 2,
      "unit": "px",
      "label": "Heading Padding Bottom",
      "default": 0,
      "info": "Controls the bottom padding around the heading text area"
    },
    {
      "type": "range",
      "id": "heading_padding_left",
      "min": 0,
      "max": 100,
      "step": 2,
      "unit": "px",
      "label": "Heading Padding Left",
      "default": 20,
      "info": "Controls the left padding around the heading text area"
    },
    {
      "type": "range",
      "id": "heading_padding_right",
      "min": 0,
      "max": 100,
      "step": 2,
      "unit": "px",
      "label": "Heading Padding Right",
      "default": 20,
      "info": "Controls the right padding around the heading text area"
    },
    {
      "type": "header",
      "content": "Age Filter Margin"
    },
    {
      "type": "range",
      "id": "age_filter_margin_top",
      "min": 0,
      "max": 100,
      "step": 2,
      "unit": "px",
      "label": "Age Filter Margin Top",
      "default": 16,
      "info": "Controls the space above the age filter buttons"
    },
    {
      "type": "range",
      "id": "age_filter_margin_bottom",
      "min": 0,
      "max": 100,
      "step": 2,
      "unit": "px",
      "label": "Age Filter Margin Bottom",
      "default": 0,
      "info": "Controls the space below the age filter buttons"
    },
    {
      "type": "header",
      "content": "Mobile Carousel Padding"
    },
    {
      "type": "range",
      "id": "mobile_carousel_padding_top",
      "min": 0,
      "max": 100,
      "step": 2,
      "unit": "px",
      "label": "Mobile Carousel Padding Top",
      "default": 20,
      "info": "Controls the top padding of the mobile carousel (visible on mobile devices only)"
    },
    {
      "type": "range",
      "id": "mobile_carousel_padding_bottom",
      "min": 0,
      "max": 100,
      "step": 2,
      "unit": "px",
      "label": "Mobile Carousel Padding Bottom",
      "default": 40,
      "info": "Controls the bottom padding of the mobile carousel (visible on mobile devices only)"
    },
    {
      "type": "range",
      "id": "mobile_carousel_padding_left",
      "min": 0,
      "max": 100,
      "step": 2,
      "unit": "px",
      "label": "Mobile Carousel Padding Left",
      "default": 0,
      "info": "Controls the left padding of the mobile carousel (visible on mobile devices only)"
    },
    {
      "type": "range",
      "id": "mobile_carousel_padding_right",
      "min": 0,
      "max": 100,
      "step": 2,
      "unit": "px",
      "label": "Mobile Carousel Padding Right",
      "default": 0,
      "info": "Controls the right padding of the mobile carousel (visible on mobile devices only)"
    },
    {
      "type": "header",
      "content": "Grid Wrap Padding (Product Grid Container)"
    },
    {
      "type": "range",
      "id": "grid_wrap_padding_top",
      "min": -100,
      "max": 200,
      "step": 4,
      "unit": "px",
      "label": "Grid Wrap Padding Top",
      "default": 0,
      "info": "Controls the top padding inside the grid container (the wrapper that contains all product tiles). Negative values will pull the grid upward."
    },
    {
      "type": "range",
      "id": "grid_wrap_padding_bottom",
      "min": 0,
      "max": 200,
      "step": 4,
      "unit": "px",
      "label": "Grid Wrap Padding Bottom",
      "default": 40,
      "info": "Controls the bottom padding inside the grid container (the wrapper that contains all product tiles)"
    },
    {
      "type": "range",
      "id": "grid_wrap_padding_left",
      "min": 0,
      "max": 200,
      "step": 4,
      "unit": "px",
      "label": "Grid Wrap Padding Left",
      "default": 40,
      "info": "Controls the left padding inside the grid container (the wrapper that contains all product tiles)"
    },
    {
      "type": "range",
      "id": "grid_wrap_padding_right",
      "min": 0,
      "max": 200,
      "step": 4,
      "unit": "px",
      "label": "Grid Wrap Padding Right",
      "default": 40,
      "info": "Controls the right padding inside the grid container (the wrapper that contains all product tiles)"
    },
    {
      "type": "header",
      "content": "Grid Settings"
    },
    {
      "type": "range",
      "id": "max_width",
      "min": 900,
      "max": 2000,
      "step": 50,
      "unit": "px",
      "label": "Max width",
      "default": 1400
    },
    {
      "type": "range",
      "id": "outer_padding",
      "min": 0,
      "max": 140,
      "step": 4,
      "unit": "px",
      "label": "Outer padding",
      "default": 40
    },
    { "type": "range", "id": "gap", "min": 0, "max": 80, "step": 2, "unit": "px", "label": "Gap", "default": 40 },

    { "type": "range", "id": "columns", "min": 3, "max": 6, "step": 1, "label": "Columns", "default": 5 },
    {
      "type": "range",
      "id": "height_vh",
      "min": 60,
      "max": 140,
      "step": 5,
      "unit": "vh",
      "label": "Section height",
      "default": 100
    },

    {
      "type": "range",
      "id": "tile_h",
      "min": 280,
      "max": 900,
      "step": 10,
      "unit": "px",
      "label": "Tile height (desktop)",
      "default": 540
    },
    {
      "type": "range",
      "id": "tile_h_mobile",
      "min": 240,
      "max": 700,
      "step": 10,
      "unit": "px",
      "label": "Tile height (mobile)",
      "default": 420
    },

    {
      "type": "color",
      "id": "tile_bg",
      "label": "Tile background (shows only if image has transparency)",
      "default": "#ffffff"
    },

    {
      "type": "select",
      "id": "image_fit",
      "label": "Image fit",
      "default": "cover",
      "options": [
        { "value": "cover", "label": "Cover (fills tile)" },
        { "value": "contain", "label": "Contain (show full image)" }
      ]
    },
    {
      "type": "range",
      "id": "image_scale",
      "min": 100,
      "max": 160,
      "step": 1,
      "unit": "%",
      "label": "Zoom (scale)",
      "default": 100
    },
    {
      "type": "range",
      "id": "image_pos_x",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "%",
      "label": "Image position X",
      "default": 50
    },
    {
      "type": "range",
      "id": "image_pos_y",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "%",
      "label": "Image position Y",
      "default": 50
    },
    {
      "type": "range",
      "id": "hover_zoom",
      "min": 100,
      "max": 140,
      "step": 1,
      "unit": "%",
      "label": "Hover zoom",
      "default": 112
    },

    { "type": "range", "id": "radius", "min": 0, "max": 90, "step": 2, "unit": "px", "label": "Radius", "default": 26 },

    {
      "type": "range",
      "id": "overlay_opacity",
      "min": 0,
      "max": 80,
      "step": 1,
      "unit": "%",
      "label": "Overlay opacity",
      "default": 0
    },
    {
      "type": "range",
      "id": "overlay_hover_opacity",
      "min": 0,
      "max": 90,
      "step": 1,
      "unit": "%",
      "label": "Overlay hover opacity",
      "default": 15
    }
  ],
  "blocks": [
    {
      "type": "tile",
      "name": "Product tile",
      "settings": [
        { "type": "product", "id": "product", "label": "Product" },
        { "type": "image_picker", "id": "custom_image", "label": "Custom image" },
        { "type": "color", "id": "text_color", "label": "Hover text color", "default": "#ffffff" },
        {
          "type": "textarea",
          "id": "age_range",
          "label": "Age Range(s)",
          "default": "all",
          "info": "Enter one or more age ranges separated by commas (e.g., '0.5-4', '5-7', '0.5-4,5-7', or 'all'). Each range must match the age range set on filter buttons. Use 'all' to show for all filters."
        }
      ]
    }
  ],
  "max_blocks": 5,
  "presets": [{ "name": "Shop color grid" }]
}
{% endschema %}
