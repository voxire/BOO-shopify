{%- liquid
  assign section_id = section.id
  assign free_shipping_amount = section.settings.free_shipping_amount | times: 100
  assign currency_symbol = cart.currency.symbol
  assign background_image = section.settings.background_image
  assign glass_enabled = section.settings.glass_enabled
  assign glass_blur = section.settings.glass_blur
  assign glass_bg_opacity = section.settings.glass_bg_opacity | divided_by: 100.0
  assign glass_border_opacity = section.settings.glass_border_opacity | divided_by: 100.0
  assign text_content = section.settings.text_content
  assign padding_top = section.settings.padding_top
  assign padding_bottom = section.settings.padding_bottom
-%}

{%- style -%}
  .window-shopping-{{ section_id }} {
    padding-top: {{ padding_top | times: 0.5 | round: 0 }}px;
    padding-bottom: {{ padding_bottom | times: 0.5 | round: 0 }}px;
  }

  @media screen and (min-width: 750px) {
    .window-shopping-{{ section_id }} {
      padding-top: {{ padding_top }}px;
      padding-bottom: {{ padding_bottom }}px;
    }
  }

  .window-shopping-{{ section_id }}__container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 2rem;
  }

  .window-shopping-{{ section_id }}__card {
    position: relative;
    border-radius: 20px;
    overflow: hidden;
    min-height: 300px;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 3rem 2rem;
  }

  {% if background_image != blank %}
    .window-shopping-{{ section_id }}__card {
      background-image: url('{{ background_image | image_url: width: 1200 }}');
      background-size: cover;
      background-position: center;
    }
  {% else %}
    .window-shopping-{{ section_id }}__card {
      background: {{ section.settings.fallback_color }};
    }
  {% endif %}

  {% if glass_enabled %}
    .window-shopping-{{ section_id }}__content {
      background: rgba(255, 255, 255, {{ glass_bg_opacity }});
      backdrop-filter: blur({{ glass_blur }}px) saturate(180%);
      -webkit-backdrop-filter: blur({{ glass_blur }}px) saturate(180%);
      border: 1px solid rgba(255, 255, 255, {{ glass_border_opacity }});
      border-radius: 16px;
      padding: 2.5rem;
      max-width: 600px;
      text-align: center;
    }
  {% else %}
    .window-shopping-{{ section_id }}__content {
      background: {{ section.settings.content_bg_color | color_modify: 'alpha', section.settings.content_bg_opacity | divided_by: 100.0 }};
      padding: 2.5rem;
      max-width: 600px;
      text-align: center;
      border-radius: 16px;
    }
  {% endif %}

  .window-shopping-{{ section_id }}__text {
    margin: 0;
    font-size: 1.5rem;
    font-weight: 600;
    line-height: 1.4;
    color: {{ section.settings.text_color }};
  }

  .window-shopping-{{ section_id }}__amount {
    font-weight: 700;
    color: {{ section.settings.accent_color }};
  }

  @media screen and (max-width: 768px) {
    .window-shopping-{{ section_id }}__container {
      padding: 0 1rem;
      width: 100%;
      max-width: 100%;
      overflow-x: hidden;
    }

    .window-shopping-{{ section_id }}__card {
      position: relative;
      min-height: 200px;
      padding: 1.5rem 1rem;
      border-radius: 16px;
      width: 100%;
      max-width: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    {% if glass_enabled %}
      .window-shopping-{{ section_id }}__content {
        position: relative;
        padding: 1.5rem 1rem;
        border-radius: 12px;
        max-width: 100%;
        width: 100%;
        box-sizing: border-box;
      }
    {% else %}
      .window-shopping-{{ section_id }}__content {
        position: relative;
        padding: 1.5rem 1rem;
        border-radius: 12px;
        max-width: 100%;
        width: 100%;
        box-sizing: border-box;
      }
    {% endif %}

    .window-shopping-{{ section_id }}__text {
      font-size: 1.125rem;
      line-height: 1.3;
      word-wrap: break-word;
      overflow-wrap: break-word;
      margin: 0;
    }
  }
{%- endstyle -%}

<section class="window-shopping-{{ section_id }}" data-section-id="{{ section.id }}">
  <div class="window-shopping-{{ section_id }}__container">
    <div class="window-shopping-{{ section_id }}__card">
      <div class="window-shopping-{{ section_id }}__content">
        {%- if text_content != blank -%}
          <p class="window-shopping-{{ section_id }}__text">
            {{ text_content | replace: '[amount]', '<span class="window-shopping-' | append: section_id | append: '__amount">' | append: currency_symbol | append: free_shipping_amount | append: '</span>' }}
          </p>
        {%- else -%}
          <p class="window-shopping-{{ section_id }}__text">
            Free shipping over <span class="window-shopping-{{ section_id }}__amount">{{ currency_symbol }}{{ free_shipping_amount | money_without_currency }}</span>
          </p>
        {%- endif -%}
      </div>
    </div>
  </div>
</section>

{% schema %}
{
  "name": "Window Shopping Card",
  "tag": "section",
  "class": "section",
  "settings": [
    {
      "type": "number",
      "id": "free_shipping_amount",
      "label": "Free Shipping Amount",
      "default": 100,
      "info": "Enter amount in dollars (e.g., 100 for $100)"
    },
    {
      "type": "textarea",
      "id": "text_content",
      "label": "Custom Text",
      "default": "Free shipping over [amount]",
      "info": "Use [amount] to insert the free shipping threshold"
    },
    {
      "type": "image_picker",
      "id": "background_image",
      "label": "Background Image"
    },
    {
      "type": "color",
      "id": "fallback_color",
      "label": "Fallback Background Color",
      "default": "#f5f5f5",
      "info": "Used when no background image is set"
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "Text Color",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "accent_color",
      "label": "Amount Accent Color",
      "default": "#000000"
    },
    {
      "type": "header",
      "content": "Glassmorphism"
    },
    {
      "type": "checkbox",
      "id": "glass_enabled",
      "label": "Enable Glassmorphism",
      "default": true
    },
    {
      "type": "range",
      "id": "glass_blur",
      "min": 0,
      "max": 40,
      "step": 1,
      "unit": "px",
      "label": "Blur Amount",
      "default": 20
    },
    {
      "type": "range",
      "id": "glass_bg_opacity",
      "min": 0,
      "max": 100,
      "step": 5,
      "unit": "%",
      "label": "Background Opacity",
      "default": 40
    },
    {
      "type": "range",
      "id": "glass_border_opacity",
      "min": 0,
      "max": 100,
      "step": 5,
      "unit": "%",
      "label": "Border Opacity",
      "default": 30
    },
    {
      "type": "header",
      "content": "Fallback Styling",
      "info": "Used when glassmorphism is disabled"
    },
    {
      "type": "color",
      "id": "content_bg_color",
      "label": "Content Background Color",
      "default": "#ffffff"
    },
    {
      "type": "range",
      "id": "content_bg_opacity",
      "min": 0,
      "max": 100,
      "step": 5,
      "unit": "%",
      "label": "Content Background Opacity",
      "default": 90
    },
    {
      "type": "header",
      "content": "Section Padding"
    },
    {
      "type": "range",
      "id": "padding_top",
      "min": 0,
      "max": 120,
      "step": 4,
      "unit": "px",
      "label": "Padding Top",
      "default": 60
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "min": 0,
      "max": 120,
      "step": 4,
      "unit": "px",
      "label": "Padding Bottom",
      "default": 60
    }
  ],
  "presets": [
    {
      "name": "Window Shopping Card"
    }
  ]
}
{% endschema %}

