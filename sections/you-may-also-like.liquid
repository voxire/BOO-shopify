{% comment %}
  Section: You might also like (shows other products)
{% endcomment %}

{% assign sid = section.id | replace: '_', '' | downcase %}
{% assign current_product = product %}
{% assign current_handle = current_product.handle %}
{% assign current_collection = current_product.collections.first %}

{% if current_collection %}
  {% assign src_products = current_collection.products %}
{% else %}
  {% assign src_products = collections.all.products %}
{% endif %}

{% style %}
.yal-{{ sid }}{width:100%;padding:56px 0;background:{{ section.settings.bg }}}
.yal-{{ sid }} .page-width{max-width:{{ section.settings.max_width }}px;margin:0 auto;padding:0 20px}
.yal-{{ sid }}__head{margin:0 0 22px}
.yal-{{ sid }}__title{margin:0 0 8px;font-size:34px;font-weight:900;color:{{ section.settings.title_color }}}
.yal-{{ sid }}__sub{margin:0;color:{{ section.settings.sub_color }};opacity:.9}

.yal-{{ sid }}__grid{
  display:grid;
  grid-template-columns:repeat({{ section.settings.columns }}, minmax(0,1fr));
  gap:{{ section.settings.gap }}px;
}

.yal-{{ sid }}__card{
  position:relative;
  overflow:hidden;
  border-radius:{{ section.settings.radius }}px;
  background:rgba(255,255,255,.06);
  border:1px solid rgba(255,255,255,.12);
  backdrop-filter: blur({{ section.settings.blur }}px);
  -webkit-backdrop-filter: blur({{ section.settings.blur }}px);
  text-decoration:none;
  display:block;
  min-height:{{ section.settings.card_height }}px;
  box-shadow:0 18px 45px rgba(0,0,0,.25);
  transition:transform .25s ease, filter .25s ease, opacity .25s ease;
}

.yal-{{ sid }}__img{position:absolute;inset:0}
.yal-{{ sid }}__img img{width:100%;height:100%;object-fit:cover;display:block;transform:scale(1);transition:transform .45s ease}

.yal-{{ sid }}__shade{
  position:absolute;inset:0;
  background:linear-gradient(180deg, rgba(0,0,0,0) 45%, rgba(0,0,0,.65) 100%);
  opacity:.95;
}

.yal-{{ sid }}__meta{
  position:absolute;
  left:18px; right:18px; bottom:16px;
  color:#fff;
}

.yal-{{ sid }}__name{margin:0 0 6px;font-weight:900;font-size:18px;line-height:1.15}
.yal-{{ sid }}__price{margin:0;font-weight:800;font-size:14px;opacity:.92}

.yal-{{ sid }}__badge{
  position:absolute;
  top:14px; left:14px;
  padding:8px 12px;
  border-radius:999px;
  background:rgba(0,0,0,.35);
  border:1px solid rgba(255,255,255,.18);
  color:#fff;
  font-weight:900;
  font-size:12px;
  letter-spacing:.02em;
  backdrop-filter: blur({{ section.settings.blur }}px);
  -webkit-backdrop-filter: blur({{ section.settings.blur }}px);
}

.yal-{{ sid }}__grid:hover .yal-{{ sid }}__card{filter:blur(4px);opacity:.65}
.yal-{{ sid }}__grid:hover .yal-{{ sid }}__card:hover{filter:none;opacity:1;transform:scale(1.03);z-index:2}
.yal-{{ sid }}__card:hover .yal-{{ sid }}__img img{transform:scale(1.08)}

@media (max-width: 990px){
  .yal-{{ sid }}__grid{grid-template-columns:repeat(2, minmax(0,1fr))}
  .yal-{{ sid }}__grid:hover .yal-{{ sid }}__card{filter:none;opacity:1;transform:none}
}
@media (max-width: 520px){
  .yal-{{ sid }}__grid{grid-template-columns:1fr}
}
{% endstyle %}

<section class="yal-{{ sid }}">
  <div class="page-width">
    <div class="yal-{{ sid }}__head">
      <h2 class="yal-{{ sid }}__title">{{ section.settings.title }}</h2>
      <p class="yal-{{ sid }}__sub">{{ section.settings.sub }}</p>
    </div>

    <div class="yal-{{ sid }}__grid">
      {% assign shown = 0 %}
      {% for p in src_products %}
        {% if p.handle != current_handle %}
          <a class="yal-{{ sid }}__card" href="{{ p.url }}">
            <div class="yal-{{ sid }}__img">
              {% if p.featured_image %}
                <img src="{{ p.featured_image | image_url: width: 1400 }}" alt="{{ p.title | escape }}" loading="lazy">
              {% else %}
                {{ 'product-1' | placeholder_svg_tag }}
              {% endif %}
            </div>
            <div class="yal-{{ sid }}__shade"></div>

            {% if section.settings.show_badge %}
              <div class="yal-{{ sid }}__badge">{{ section.settings.badge_text }}</div>
            {% endif %}

            <div class="yal-{{ sid }}__meta">
              <p class="yal-{{ sid }}__name">{{ p.title }}</p>
              <p class="yal-{{ sid }}__price">{{ p.price | money }}</p>
            </div>
          </a>

          {% assign shown = shown | plus: 1 %}
          {% if shown >= section.settings.limit %}{% break %}{% endif %}
        {% endif %}
      {% endfor %}
    </div>
  </div>
</section>

{% schema %}
{
  "name": "You might also like",
  "tag": "section",
  "settings": [
    { "type": "text", "id": "title", "label": "Title", "default": "You might also like" },
    { "type": "text", "id": "sub", "label": "Subtitle", "default": "More options you may want to check." },

    { "type": "color", "id": "bg", "label": "Background", "default": "#0b0b0b" },
    { "type": "color", "id": "title_color", "label": "Title color", "default": "#ffffff" },
    { "type": "color", "id": "sub_color", "label": "Subtitle color", "default": "#d9d9d9" },

    { "type": "range", "id": "max_width", "min": 900, "max": 1800, "step": 50, "unit": "px", "label": "Max width", "default": 1400 },
    { "type": "range", "id": "columns", "min": 2, "max": 5, "step": 1, "label": "Columns", "default": 4 },
    { "type": "range", "id": "gap", "min": 8, "max": 40, "step": 2, "unit": "px", "label": "Gap", "default": 16 },
    { "type": "range", "id": "radius", "min": 0, "max": 40, "step": 2, "unit": "px", "label": "Radius", "default": 22 },
    { "type": "range", "id": "blur", "min": 0, "max": 24, "step": 1, "unit": "px", "label": "Glass blur", "default": 10 },
    { "type": "range", "id": "card_height", "min": 180, "max": 460, "step": 10, "unit": "px", "label": "Card height", "default": 260 },

    { "type": "range", "id": "limit", "min": 2, "max": 12, "step": 1, "label": "How many products", "default": 4 },

    { "type": "checkbox", "id": "show_badge", "label": "Show badge", "default": false },
    { "type": "text", "id": "badge_text", "label": "Badge text", "default": "More" }
  ],
  "presets": [{ "name": "You might also like" }]
}
{% endschema %}
